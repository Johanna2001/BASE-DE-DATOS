  /*CONSULTA1 */
/*Histórico de ingresos de los tipos de seguros por año 
y cuanto fue el pago que le dio ese año a la empresa*/

SELECT YEAR (FACTURA.FACTURA_FECHA) AS AÑO, POLIZA_SEGURO, SUM (FACTURA.FACTURA_TOTAL) FROM FACTURA 
inner join RELATIONSHIP_8 on FACTURA.POLIZA_ID=RELATIONSHIP_8.POLIZA_ID 
group by  YEAR (FACTURA.FACTURA_FECHA), POLIZA_SEGURO ORDER BY YEAR (FACTURA.FACTURA_FECHA)

/*CONSULTA 2
Histórico de pago que la institución esta haciendo por cada banco a las personas k se jubilaron año a año*/

SELECT INSTITUCION_BANCARIA, count (INSTITUCION_BANCARIA)AS CANTIDAD_JUBILADOS, YEAR (FACTURA.FACTURA_FECHA) AS AÑO, 
SUM(FACTURA_TOTAL) AS PAGO_TOTAL FROM FACTURA
INNER JOIN CLIENTE on CLIENTE.ID_CLIENTE=FACTURA.NUMERO_FACTURA WHERE ESTADO_CLIENTE='JUBILADO' 
group by YEAR (FACTURA.FACTURA_FECHA), INSTITUCION_BANCARIA

/* CONSULTA 3
Histórico de los nombres de los clientes, el costo de la póliza, el seguro que compro cada uno de ellos y el nombre del vendedor.*/

SELECT CONCAT (NOMBRE_CLIENTE,' ', APELLIDOS_CLIENTE) AS NOMBRE_CLIENTE,
SUM(POLIZA_COSTO) AS COSTO, POLIZA_SEGURO, CONCAT(NOMBRE_AGENTE,' ', APELLIDO_AGENTE) 
AS AGENTE_VENDEDOR FROM CLIENTE 
INNER JOIN RELATIONSHIP_8 ON RELATIONSHIP_8.ID_CLIENTE=CLIENTE.ID_CLIENTE
INNER JOIN POLIZA on RELATIONSHIP_8.POLIZA_ID=POLIZA.POLIZA_ID
INNER JOIN AGENTE_VENDEDOR on AGENTE_VENDEDOR.POLIZA_ID=POLIZA.POLIZA_ID
group by CONCAT (NOMBRE_CLIENTE,' ', APELLIDOS_CLIENTE), POLIZA_SEGURO, CONCAT(NOMBRE_AGENTE,' ', APELLIDO_AGENTE)

/* CONSULTA 4 
Histórico de retiros de las personas por año */

SELECT ESTADO_CLIENTE, COUNT (ESTADO_CLIENTE) AS CANTIDAD, YEAR (FACTURA.FACTURA_FECHA) AS AÑO FROM CLIENTE
inner join FACTURA on FACTURA.ID_CLIENTE=CLIENTE.ID_CLIENTE WHERE ESTADO_CLIENTE='Retirado' 
group by YEAR (FACTURA.FACTURA_FECHA), ESTADO_CLIENTE
